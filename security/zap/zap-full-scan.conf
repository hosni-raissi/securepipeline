# ZAP Full Scan Configuration
# This performs active scanning including attacks

# Context configuration
contexts:
  - name: "SecurePipeline"
    urls:
      - "http://app:5000"
    includePaths:
      - "http://app:5000/.*"
    excludePaths:
      - "http://app:5000/static/.*"
    authentication:
      type: "form"
      loginUrl: "http://app:5000/login"
      loginRequestData: "username={%username%}&password={%password%}"
    users:
      - name: "testuser"
        credentials:
          username: "user"
          password: "user123"

# Active scan configuration
activeScan:
  policy: "Default Policy"
  maxRuleDurationInMins: 10
  maxScanDurationInMins: 30
  threadPerHost: 2
  
# Scan rules strength
scanPolicy:
  rules:
    - id: 40012  # SQL Injection
      strength: "HIGH"
      threshold: "LOW"
    - id: 40014  # Cross Site Scripting (Persistent)
      strength: "HIGH"
      threshold: "LOW"
    - id: 40016  # Cross Site Scripting (Reflected)
      strength: "HIGH"
      threshold: "LOW"
    - id: 90019  # Server Side Code Injection
      strength: "HIGH"
      threshold: "LOW"
    - id: 90020  # Remote OS Command Injection
      strength: "HIGH"
      threshold: "LOW"

# Alert filters
alertFilters:
  - ruleId: 10021
    action: "IGNORE"
    context: ".*"
    url: ".*"
    parameter: ".*"
